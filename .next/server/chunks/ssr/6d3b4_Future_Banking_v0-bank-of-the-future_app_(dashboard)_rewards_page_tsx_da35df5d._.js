module.exports=[27583,a=>{"use strict";var b=a.i(74419),c=a.i(57683),d=a.i(20949),e=a.i(4627),f=a.i(73795),g=a.i(60696),h=a.i(69507),i=a.i(42562),j=a.i(92645),k=a.i(43253),l=a.i(52271),m=a.i(70868),n=a.i(40226);let o=(0,n.default)("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),p=(0,n.default)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);var q=a.i(9156);a.i(59914),a.i(8127),a.i(23305);var r=a.i(38448),s=a.i(72438),t=a.i(10496),u=a.i(21478),v=a.i(80351);function w(){let{currentUser:a}=(0,d.useRole)(),[h,n]=(0,c.useState)(null),[t,w]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(!0),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(!1);(0,c.useEffect)(()=>{!async function(){if(!a?.id)return;B(!0);let b=(0,l.createClient)(),{data:c}=await b.from("reward_profiles").select("*").eq("user_id",a.id).single();c?n({userId:c.user_id,totalPoints:c.total_points,lifetimePoints:c.lifetime_points,tier:c.tier,nextTierProgress:Number(c.next_tier_progress)}):n({userId:a.id,totalPoints:0,lifetimePoints:0,tier:"Bronze",nextTierProgress:0});let{data:d}=await b.from("reward_catalog").select("*").order("points_cost",{ascending:!0});d&&w(d.map(a=>({id:a.id,name:a.name,description:a.description,pointsCost:a.points_cost,category:a.category,imageUrl:a.image_url,isFeatured:a.is_featured,stockQuantity:a.stock_quantity})));let{data:e}=await b.from("reward_activities").select("*").eq("user_id",a.id).order("created_at",{ascending:!1}).limit(10);e&&z(e.map(a=>({id:a.id,userId:a.user_id,amount:a.amount,type:a.type,category:a.category,description:a.description,createdAt:a.created_at}))),B(!1)}()},[a]);let G=async b=>{if(h&&!(h.totalPoints<b.pointsCost))try{let c=(0,l.createClient)(),{error:d}=await c.from("reward_activities").insert({user_id:a?.id,amount:-b.pointsCost,type:"redeemed",category:b.category,description:`Redeemed: ${b.name}`});if(d)throw d;let{error:e}=await c.rpc("deduct_points",{p_user_id:a?.id,p_amount:b.pointsCost});e&&await c.from("reward_profiles").update({total_points:h.totalPoints-b.pointsCost}).eq("user_id",a.id),n(a=>a?{...a,totalPoints:a.totalPoints-b.pointsCost}:null),F(!0);let{data:f}=await c.from("reward_activities").select("*").eq("user_id",a?.id).order("created_at",{ascending:!1}).limit(10);f&&z(f.map(a=>({id:a.id,userId:a.user_id,amount:a.amount,type:a.type,category:a.category,description:a.description,createdAt:a.created_at})))}catch(a){console.error("Redemption failed:",a)}};return A?(0,b.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,b.jsx)(r.Loader2,{className:"h-8 w-8 animate-spin text-primary"})}):h?(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(e.PageHeader,{title:"Rewards",description:"Earn points and redeem exclusive rewards"}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(f.Card,{className:"md:col-span-2 bg-gradient-to-br from-primary/10 via-primary/5 to-transparent border-primary/20",children:(0,b.jsxs)(f.CardContent,{className:"p-6",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-1",children:"Available Points"}),(0,b.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,b.jsx)("h2",{className:"text-4xl font-bold text-primary",children:h.totalPoints.toLocaleString()}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"pts"})]})]}),(0,b.jsxs)("div",{className:`px-4 py-2 rounded-lg border ${(a=>{switch(a){case"Platinum":return"text-indigo-500 bg-indigo-500/10 border-indigo-500/20";case"Gold":return"text-amber-500 bg-amber-500/10 border-amber-500/20";case"Silver":return"text-slate-500 bg-slate-500/10 border-slate-500/20";default:return"text-orange-700 bg-orange-700/10 border-orange-700/20"}})(h.tier)} flex items-center gap-2`,children:[(0,b.jsx)(o,{className:"h-5 w-5"}),(0,b.jsxs)("span",{className:"font-semibold",children:[h.tier," Member"]})]})]}),(0,b.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsxs)("span",{children:["Progress to ","Gold"===h.tier?"Platinum":"Silver"===h.tier?"Gold":"Silver"]}),(0,b.jsxs)("span",{children:[h.nextTierProgress,"%"]})]}),(0,b.jsx)(i.Progress,{value:h.nextTierProgress,className:"h-2"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Earn ",2e3," more points to upgrade your tier and unlock exclusive benefits."]})]})]})}),(0,b.jsx)("div",{className:"md:col-span-1",children:(0,b.jsx)(u.AskAIBankerWidget,{questions:["How do I earn more points?","What rewards can I afford?","When do my points expire?","Show me travel rewards"],description:"Maximize your rewards"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,b.jsxs)(j.Tabs,{defaultValue:"all",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"Rewards Catalog"}),(0,b.jsxs)(j.TabsList,{children:[(0,b.jsx)(j.TabsTrigger,{value:"all",children:"All"}),(0,b.jsx)(j.TabsTrigger,{value:"travel",children:"Travel"}),(0,b.jsx)(j.TabsTrigger,{value:"gadget",children:"Gadgets"}),(0,b.jsx)(j.TabsTrigger,{value:"gift_card",children:"Vouchers"})]})]}),(0,b.jsx)(j.TabsContent,{value:"all",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.map(a=>(0,b.jsx)(x,{item:a,canAfford:h.totalPoints>=a.pointsCost,onRedeem:()=>D(a)},a.id))})}),(0,b.jsx)(j.TabsContent,{value:"travel",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.filter(a=>"travel"===a.category).map(a=>(0,b.jsx)(x,{item:a,canAfford:h.totalPoints>=a.pointsCost,onRedeem:()=>D(a)},a.id))})}),(0,b.jsx)(j.TabsContent,{value:"gadget",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.filter(a=>"gadget"===a.category).map(a=>(0,b.jsx)(x,{item:a,canAfford:h.totalPoints>=a.pointsCost,onRedeem:()=>D(a)},a.id))})}),(0,b.jsx)(j.TabsContent,{value:"gift_card",className:"space-y-4",children:(0,b.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:t.filter(a=>"gift_card"===a.category).map(a=>(0,b.jsx)(x,{item:a,canAfford:h.totalPoints>=a.pointsCost,onRedeem:()=>D(a)},a.id))})})]})}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)(f.Card,{children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(p,{className:"h-5 w-5 text-primary"}),(0,b.jsx)(f.CardTitle,{children:"History"})]})}),(0,b.jsx)(f.CardContent,{className:"p-0",children:(0,b.jsx)("div",{className:"divide-y",children:y.map(a=>(0,b.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:a.description}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString()})]}),(0,b.jsxs)("span",{className:`font-bold text-sm ${a.amount>0?"text-emerald-500":"text-red-500"}`,children:[a.amount>0?"+":"",a.amount]})]},a.id))})})]}),(0,b.jsxs)(f.Card,{className:"bg-gradient-to-br from-indigo-500/10 to-purple-500/10 border-indigo-500/20",children:[(0,b.jsx)(f.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(q.Sparkles,{className:"h-5 w-5 text-indigo-500"}),(0,b.jsx)(f.CardTitle,{className:"text-indigo-700 dark:text-indigo-300",children:"Boost Your Points"})]})}),(0,b.jsx)(f.CardContent,{children:(0,b.jsxs)("ul",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(s.CheckCircle2,{className:"h-4 w-4 text-emerald-500 shrink-0"}),(0,b.jsx)("span",{children:"Refer a friend (+2,000 pts)"})]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(s.CheckCircle2,{className:"h-4 w-4 text-emerald-500 shrink-0"}),(0,b.jsx)("span",{children:"Connect Marketplace App (+500 pts)"})]}),(0,b.jsxs)("li",{className:"flex gap-2",children:[(0,b.jsx)(s.CheckCircle2,{className:"h-4 w-4 text-emerald-500 shrink-0"}),(0,b.jsx)("span",{children:"Complete Risk Profile (+250 pts)"})]})]})})]})]})]}),(0,b.jsx)(v.Sheet,{open:!!C,onOpenChange:a=>!a&&D(null),children:(0,b.jsxs)(v.SheetContent,{children:[(0,b.jsxs)(v.SheetHeader,{children:[(0,b.jsx)(v.SheetTitle,{children:"Redeem Reward"}),(0,b.jsx)(v.SheetDescription,{children:"Confirm your selection"})]}),C&&(0,b.jsxs)("div",{className:"mt-6 space-y-6",children:[(0,b.jsx)("div",{className:"aspect-video relative rounded-lg overflow-hidden bg-muted",children:(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center text-muted-foreground",children:(0,b.jsx)(m.Gift,{className:"h-12 w-12"})})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-xl font-bold",children:C.name}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:C.description})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 bg-muted/30 rounded-lg",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Cost"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"text-xl font-bold text-primary",children:C.pointsCost.toLocaleString()}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"pts"})]})]}),E?(0,b.jsxs)(k.Alert,{className:"border-emerald-500/50 bg-emerald-500/10",children:[(0,b.jsx)(s.CheckCircle2,{className:"h-4 w-4 text-emerald-500"}),(0,b.jsx)(k.AlertTitle,{className:"text-emerald-500",children:"Success!"}),(0,b.jsx)(k.AlertDescription,{className:"text-emerald-600/90",children:"Your reward has been redeemed successfully. Check your email for details."})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,b.jsx)("span",{children:"Your Balance"}),(0,b.jsxs)("span",{children:[h.totalPoints.toLocaleString()," pts"]})]}),(0,b.jsxs)("div",{className:"flex justify-between text-sm font-medium",children:[(0,b.jsx)("span",{children:"Balance After"}),(0,b.jsxs)("span",{className:h.totalPoints<C.pointsCost?"text-red-500":"",children:[(h.totalPoints-C.pointsCost).toLocaleString()," pts"]})]}),(0,b.jsx)(g.Button,{className:"w-full",size:"lg",disabled:h.totalPoints<C.pointsCost,onClick:()=>G(C),children:h.totalPoints>=C.pointsCost?"Confirm Redemption":"Insufficient Points"})]})]})]})})]}):null}function x({item:a,canAfford:c,onRedeem:d}){return(0,b.jsxs)(f.Card,{className:"flex flex-col overflow-hidden hover:shadow-md transition-all",children:[(0,b.jsxs)("div",{className:"h-32 bg-muted relative",children:[(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-muted",children:(0,b.jsx)(m.Gift,{className:"h-8 w-8 text-muted-foreground/50"})}),a.isFeatured&&(0,b.jsx)(h.Badge,{className:"absolute top-2 right-2 bg-amber-500",children:"Featured"})]}),(0,b.jsxs)(f.CardContent,{className:"p-4 flex-1 flex flex-col",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h4",{className:"font-semibold line-clamp-1",title:a.name,children:a.name}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1 h-10",children:a.description})]}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"font-bold text-primary",children:[a.pointsCost.toLocaleString()," pts"]}),(0,b.jsx)(g.Button,{size:"sm",variant:c?"default":"secondary",disabled:!c,onClick:d,children:c?"Redeem":(0,b.jsx)(t.Lock,{className:"h-3 w-3"})})]})]})]})}a.s(["default",()=>w],27583)}];

//# sourceMappingURL=6d3b4_Future_Banking_v0-bank-of-the-future_app_%28dashboard%29_rewards_page_tsx_da35df5d._.js.map